{
	"info": {
		"_postman_id": "545e29c8-082c-4b3c-9a3d-7aaf837c0789",
		"name": "Transfer Aggregator Service",
		"description": "Complete test collection for the Airport Transfer Aggregator API. Covers all endpoints: Search, Polling, Pricing, Book, Cancel, Booking Change, and Alerts.",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "00 - Setup",
			"item": [
				{
					"name": "Health Check",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status is 200', () => pm.response.to.have.status(200));",
									"pm.test('Status is UP', () => pm.expect(pm.response.json().status).to.eql('UP'));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/actuator/health",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"actuator",
								"health"
							]
						}
					}
				},
				{
					"name": "Prometheus Metrics",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/actuator/prometheus",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"actuator",
								"prometheus"
							]
						}
					}
				}
			]
		},
		{
			"name": "01 - Search",
			"item": [
				{
					"name": "S-001 Valid Address Search",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status is 200', () => pm.response.to.have.status(200));",
									"pm.test('Has offers', () => { var json = pm.response.json(); pm.expect(json.offers).to.be.an('array'); });",
									"pm.test('Has searchId', () => { var json = pm.response.json(); pm.expect(json.searchId).to.be.a('string'); pm.collectionVariables.set('searchId', json.searchId); });",
									"var json = pm.response.json(); if (json.offers && json.offers.length > 0) { pm.collectionVariables.set('offerId', json.offers[0].offerId); }"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "X-Request-Id",
								"value": "{{$guid}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"pickupLocation\": {\"address\": \"433 Park Avenue, New York, NY 10022\"},\n  \"dropoffLocation\": {\"address\": \"JFK Airport, Queens, NY 11430\"},\n  \"pickupDateTime\": \"2026-08-16T15:30:00\",\n  \"numPassengers\": 2,\n  \"numBags\": 2,\n  \"currency\": \"USD\",\n  \"mode\": \"ONE_WAY\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/transfers/search",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"transfers",
								"search"
							]
						}
					}
				},
				{
					"name": "S-002 IATA Airport Search",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status is 200', () => pm.response.to.have.status(200));",
									"pm.test('Has searchId', () => { var json = pm.response.json(); pm.expect(json.searchId).to.be.a('string'); });"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "X-Request-Id",
								"value": "{{$guid}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"pickupLocation\": {\"address\": \"Times Square, NYC\"},\n  \"dropoffLocation\": {\"iataCode\": \"JFK\"},\n  \"pickupDateTime\": \"2026-08-20T10:00:00\",\n  \"numPassengers\": 3,\n  \"numBags\": 4,\n  \"currency\": \"USD\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/transfers/search",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"transfers",
								"search"
							]
						}
					}
				},
				{
					"name": "S-003 Coordinates Search",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status is 200', () => pm.response.to.have.status(200));",
									"pm.test('Has searchId', () => pm.expect(pm.response.json().searchId).to.be.a('string'));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"pickupLocation\": {\"latitude\": 40.7580, \"longitude\": -73.9855},\n  \"dropoffLocation\": {\"latitude\": 40.6413, \"longitude\": -73.7781},\n  \"pickupDateTime\": \"2026-09-01T14:00:00\",\n  \"numPassengers\": 1,\n  \"numBags\": 1,\n  \"currency\": \"EUR\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/transfers/search",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"transfers",
								"search"
							]
						}
					}
				},
				{
					"name": "S-004 Round Trip Search",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status is 200', () => pm.response.to.have.status(200));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"pickupLocation\": {\"iataCode\": \"LAX\"},\n  \"dropoffLocation\": {\"address\": \"Beverly Hills, CA 90210\"},\n  \"pickupDateTime\": \"2026-10-15T09:00:00\",\n  \"numPassengers\": 4,\n  \"numBags\": 6,\n  \"currency\": \"USD\",\n  \"mode\": \"ROUND_TRIP\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/transfers/search",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"transfers",
								"search"
							]
						}
					}
				},
				{
					"name": "S-005 Large Group (8 passengers)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status is 200', () => pm.response.to.have.status(200));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"pickupLocation\": {\"iataCode\": \"ORD\"},\n  \"dropoffLocation\": {\"address\": \"Downtown Chicago, IL\"},\n  \"pickupDateTime\": \"2026-11-20T18:00:00\",\n  \"numPassengers\": 8,\n  \"numBags\": 10,\n  \"currency\": \"USD\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/transfers/search",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"transfers",
								"search"
							]
						}
					}
				},
				{
					"name": "S-101 Missing Pickup Location (400)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status is 400', () => pm.response.to.have.status(400));",
									"pm.test('Has error structure', () => { var json = pm.response.json(); pm.expect(json).to.have.property('code'); pm.expect(json).to.have.property('message'); });"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"dropoffLocation\": {\"iataCode\": \"JFK\"},\n  \"pickupDateTime\": \"2026-08-16T15:30:00\",\n  \"numPassengers\": 2\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/transfers/search",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"transfers",
								"search"
							]
						}
					}
				},
				{
					"name": "S-102 Missing Dropoff Location (400)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status is 400', () => pm.response.to.have.status(400));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"pickupLocation\": {\"address\": \"123 Main St\"},\n  \"pickupDateTime\": \"2026-08-16T15:30:00\",\n  \"numPassengers\": 2\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/transfers/search",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"transfers",
								"search"
							]
						}
					}
				},
				{
					"name": "S-103 Zero Passengers (400)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status is 400', () => pm.response.to.have.status(400));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"pickupLocation\": {\"address\": \"123 Main St\"},\n  \"dropoffLocation\": {\"iataCode\": \"JFK\"},\n  \"pickupDateTime\": \"2026-08-16T15:30:00\",\n  \"numPassengers\": 0\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/transfers/search",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"transfers",
								"search"
							]
						}
					}
				},
				{
					"name": "S-104 Invalid IATA Too Long (400)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status is 400', () => pm.response.to.have.status(400));",
									"pm.test('Validation error', () => pm.expect(pm.response.json().code).to.eql('VALIDATION_ERROR'));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"pickupLocation\": {\"address\": \"NYC\"},\n  \"dropoffLocation\": {\"iataCode\": \"JFKXX\"},\n  \"numPassengers\": 2\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/transfers/search",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"transfers",
								"search"
							]
						}
					}
				},
				{
					"name": "S-105 Address Too Long (400)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status is 400', () => pm.response.to.have.status(400));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"pickupLocation\": {\"address\": \"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},\n  \"dropoffLocation\": {\"iataCode\": \"JFK\"},\n  \"numPassengers\": 2\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/transfers/search",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"transfers",
								"search"
							]
						}
					}
				}
			]
		},
		{
			"name": "02 - Polling",
			"item": [
				{
					"name": "P-001 Basic Poll",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status is 200', () => pm.response.to.have.status(200));",
									"pm.test('Has offers array', () => pm.expect(pm.response.json().offers).to.be.an('array'));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "X-Request-Id",
								"value": "{{$guid}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/v1/transfers/search/{{searchId}}/poll",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"transfers",
								"search",
								"{{searchId}}",
								"poll"
							]
						}
					}
				},
				{
					"name": "P-002 Poll with Price Filter",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status is 200', () => pm.response.to.have.status(200));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/v1/transfers/search/{{searchId}}/poll?minPrice=50&maxPrice=500",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"transfers",
								"search",
								"{{searchId}}",
								"poll"
							],
							"query": [
								{
									"key": "minPrice",
									"value": "50"
								},
								{
									"key": "maxPrice",
									"value": "500"
								}
							]
						}
					}
				},
				{
					"name": "P-003 Poll with Pagination",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status is 200', () => pm.response.to.have.status(200));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/v1/transfers/search/{{searchId}}/poll?page=0&size=5",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"transfers",
								"search",
								"{{searchId}}",
								"poll"
							],
							"query": [
								{
									"key": "page",
									"value": "0"
								},
								{
									"key": "size",
									"value": "5"
								}
							]
						}
					}
				},
				{
					"name": "P-004 Poll with Sort by Rating",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status is 200', () => pm.response.to.have.status(200));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/v1/transfers/search/{{searchId}}/poll?sortBy=RATING&sortDir=DESC",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"transfers",
								"search",
								"{{searchId}}",
								"poll"
							],
							"query": [
								{
									"key": "sortBy",
									"value": "RATING"
								},
								{
									"key": "sortDir",
									"value": "DESC"
								}
							]
						}
					}
				},
				{
					"name": "P-005 Poll with Vehicle Filter",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status is 200', () => pm.response.to.have.status(200));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/v1/transfers/search/{{searchId}}/poll?vehicleTypes=sedan&vehicleTypes=suv",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"transfers",
								"search",
								"{{searchId}}",
								"poll"
							],
							"query": [
								{
									"key": "vehicleTypes",
									"value": "sedan"
								},
								{
									"key": "vehicleTypes",
									"value": "suv"
								}
							]
						}
					}
				},
				{
					"name": "P-006 Poll Free Cancellation Only",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status is 200', () => pm.response.to.have.status(200));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/v1/transfers/search/{{searchId}}/poll?freeCancellationOnly=true",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"transfers",
								"search",
								"{{searchId}}",
								"poll"
							],
							"query": [
								{
									"key": "freeCancellationOnly",
									"value": "true"
								}
							]
						}
					}
				},
				{
					"name": "P-101 Invalid SearchId (400)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status is 400', () => pm.response.to.have.status(400));",
									"pm.test('Error code INVALID_TOKEN', () => pm.expect(pm.response.json().code).to.eql('INVALID_TOKEN'));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/v1/transfers/search/not-a-valid-search-id/poll",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"transfers",
								"search",
								"not-a-valid-search-id",
								"poll"
							]
						}
					}
				}
			]
		},
		{
			"name": "03 - Pricing",
			"item": [
				{
					"name": "PR-001 Calculate Price (POST)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status is 200', () => pm.response.to.have.status(200));",
									"pm.test('Has totalPrice', () => pm.expect(pm.response.json().totalPrice).to.be.an('object'));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "X-Request-Id",
								"value": "{{$guid}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"searchId\": \"{{searchId}}\",\n  \"offerId\": \"{{offerId}}\",\n  \"amenities\": []\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/pricing",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"pricing"
							]
						}
					}
				},
				{
					"name": "PR-002 Calculate Price with Amenities",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status is 200', () => pm.response.to.have.status(200));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"searchId\": \"{{searchId}}\",\n  \"offerId\": \"{{offerId}}\",\n  \"amenities\": [\"wifi\", \"baby_seat\"]\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/pricing",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"pricing"
							]
						}
					}
				},
				{
					"name": "PR-003 Get Price (GET)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status is 200', () => pm.response.to.have.status(200));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "X-Request-Id",
								"value": "{{$guid}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/v1/pricing?searchId={{searchId}}&offerId={{offerId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"pricing"
							],
							"query": [
								{
									"key": "searchId",
									"value": "{{searchId}}"
								},
								{
									"key": "offerId",
									"value": "{{offerId}}"
								}
							]
						}
					}
				},
				{
					"name": "PR-004 Get Available Amenities",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status is 200', () => pm.response.to.have.status(200));",
									"pm.test('Returns array', () => pm.expect(pm.response.json()).to.be.an('array'));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "X-Request-Id",
								"value": "{{$guid}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/v1/pricing/{{offerId}}/amenities",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"pricing",
								"{{offerId}}",
								"amenities"
							]
						}
					}
				},
				{
					"name": "PR-101 Missing SearchId (400)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status is 400', () => pm.response.to.have.status(400));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"offerId\": \"{{offerId}}\",\n  \"amenities\": []\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/pricing",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"pricing"
							]
						}
					}
				},
				{
					"name": "PR-102 Invalid OfferId (400)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status is 400', () => pm.response.to.have.status(400));",
									"pm.test('Error is INVALID_TOKEN', () => pm.expect(pm.response.json().code).to.eql('INVALID_TOKEN'));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"searchId\": \"{{searchId}}\",\n  \"offerId\": \"invalid-offer-token\",\n  \"amenities\": []\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/pricing",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"pricing"
							]
						}
					}
				}
			]
		},
		{
			"name": "04 - Book",
			"item": [
				{
					"name": "B-001 Valid Booking",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"pm.collectionVariables.set('idempotencyKey', 'book-' + Date.now());"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status is 200', () => pm.response.to.have.status(200));",
									"pm.test('Has bookingId', () => { var json = pm.response.json(); pm.expect(json.bookingId).to.be.a('string'); pm.collectionVariables.set('bookingId', json.bookingId); });",
									"pm.test('Status is CONFIRMED or PENDING', () => pm.expect(['CONFIRMED', 'PENDING']).to.include(pm.response.json().status));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Idempotency-Key",
								"value": "{{idempotencyKey}}"
							},
							{
								"key": "X-Request-Id",
								"value": "{{$guid}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"offerId\": \"{{offerId}}\",\n  \"passenger\": {\n    \"firstName\": \"John\",\n    \"lastName\": \"Doe\",\n    \"email\": \"john.doe@example.com\",\n    \"phoneNumber\": \"+18005551234\",\n    \"countryCode\": \"US\"\n  },\n  \"flight\": {\n    \"airline\": \"AA\",\n    \"flightNumber\": \"123\"\n  },\n  \"specialInstructions\": \"Please wait at arrivals exit 3\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/transfers/book",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"transfers",
								"book"
							]
						}
					}
				},
				{
					"name": "B-002 Idempotent Booking (Same Key)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status is 200 (cached)', () => pm.response.to.have.status(200));",
									"pm.test('Same bookingId', () => pm.expect(pm.response.json().bookingId).to.eql(pm.collectionVariables.get('bookingId')));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Idempotency-Key",
								"value": "{{idempotencyKey}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"offerId\": \"{{offerId}}\",\n  \"passenger\": {\n    \"firstName\": \"John\",\n    \"lastName\": \"Doe\",\n    \"email\": \"john.doe@example.com\",\n    \"phoneNumber\": \"+18005551234\",\n    \"countryCode\": \"US\"\n  }\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/transfers/book",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"transfers",
								"book"
							]
						}
					}
				},
				{
					"name": "B-003 With Extra Passengers",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"pm.collectionVariables.set('idempotencyKey2', 'book-extra-' + Date.now());"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status is 200', () => pm.response.to.have.status(200));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Idempotency-Key",
								"value": "{{idempotencyKey2}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"offerId\": \"{{offerId}}\",\n  \"passenger\": {\n    \"firstName\": \"Alice\",\n    \"lastName\": \"Smith\",\n    \"email\": \"alice@example.com\",\n    \"phoneNumber\": \"+18005559999\",\n    \"countryCode\": \"US\"\n  },\n  \"extraPassengers\": [\n    {\"firstName\": \"Bob\", \"lastName\": \"Smith\"},\n    {\"firstName\": \"Charlie\", \"lastName\": \"Smith\"}\n  ],\n  \"flight\": {\"airline\": \"UA\", \"flightNumber\": \"456\"}\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/transfers/book",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"transfers",
								"book"
							]
						}
					}
				},
				{
					"name": "B-101 Invalid OfferId (400)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status is 400', () => pm.response.to.have.status(400));",
									"pm.test('Error is INVALID_TOKEN', () => pm.expect(pm.response.json().code).to.eql('INVALID_TOKEN'));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"offerId\": \"not-a-valid-token\",\n  \"passenger\": {\n    \"firstName\": \"John\",\n    \"lastName\": \"Doe\",\n    \"email\": \"john@example.com\",\n    \"phoneNumber\": \"+18005551234\",\n    \"countryCode\": \"US\"\n  }\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/transfers/book",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"transfers",
								"book"
							]
						}
					}
				},
				{
					"name": "B-102 Missing OfferId (400)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status is 400', () => pm.response.to.have.status(400));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"passenger\": {\n    \"firstName\": \"John\",\n    \"lastName\": \"Doe\",\n    \"email\": \"john@example.com\",\n    \"phoneNumber\": \"+18005551234\",\n    \"countryCode\": \"US\"\n  }\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/transfers/book",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"transfers",
								"book"
							]
						}
					}
				},
				{
					"name": "B-103 Missing FirstName (400)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status is 400', () => pm.response.to.have.status(400));",
									"pm.test('Validation error', () => pm.expect(pm.response.json().code).to.eql('VALIDATION_ERROR'));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"offerId\": \"{{offerId}}\",\n  \"passenger\": {\n    \"lastName\": \"Doe\",\n    \"email\": \"john@example.com\",\n    \"phoneNumber\": \"+18005551234\",\n    \"countryCode\": \"US\"\n  }\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/transfers/book",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"transfers",
								"book"
							]
						}
					}
				},
				{
					"name": "B-104 Invalid Email (400)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status is 400', () => pm.response.to.have.status(400));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"offerId\": \"{{offerId}}\",\n  \"passenger\": {\n    \"firstName\": \"John\",\n    \"lastName\": \"Doe\",\n    \"email\": \"not-an-email\",\n    \"phoneNumber\": \"+18005551234\",\n    \"countryCode\": \"US\"\n  }\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/transfers/book",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"transfers",
								"book"
							]
						}
					}
				},
				{
					"name": "B-105 Missing PhoneNumber (400)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status is 400', () => pm.response.to.have.status(400));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"offerId\": \"{{offerId}}\",\n  \"passenger\": {\n    \"firstName\": \"John\",\n    \"lastName\": \"Doe\",\n    \"email\": \"john@example.com\",\n    \"countryCode\": \"US\"\n  }\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/transfers/book",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"transfers",
								"book"
							]
						}
					}
				},
				{
					"name": "B-106 Tampered Signature (400)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status is 400', () => pm.response.to.have.status(400));",
									"pm.test('Error is INVALID_TOKEN', () => pm.expect(pm.response.json().code).to.eql('INVALID_TOKEN'));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"offerId\": \"eyJzdXAiOiJNT1pJTyIsInNpZCI6ImFiYyIsInJpZCI6Inh5eiIsImV4cCI6OTk5OTk5OTk5OSwiaWF0IjoxNzM2NTE5MDAwfQ.TAMPERED_SIG\",\n  \"passenger\": {\n    \"firstName\": \"John\",\n    \"lastName\": \"Doe\",\n    \"email\": \"john@example.com\",\n    \"phoneNumber\": \"+18005551234\",\n    \"countryCode\": \"US\"\n  }\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/transfers/book",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"transfers",
								"book"
							]
						}
					}
				}
			]
		},
		{
			"name": "05 - Cancel",
			"item": [
				{
					"name": "C-001 Valid Cancel",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status is 200', () => pm.response.to.have.status(200));",
									"pm.test('Status is CANCELLED', () => pm.expect(pm.response.json().status).to.eql('CANCELLED'));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "X-Request-Id",
								"value": "{{$guid}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/v1/transfers/bookings/{{bookingId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"transfers",
								"bookings",
								"{{bookingId}}"
							]
						}
					}
				},
				{
					"name": "C-002 Idempotent Cancel",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status is 200', () => pm.response.to.have.status(200));",
									"pm.test('Status is CANCELLED', () => pm.expect(pm.response.json().status).to.eql('CANCELLED'));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/v1/transfers/bookings/{{bookingId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"transfers",
								"bookings",
								"{{bookingId}}"
							]
						}
					}
				},
				{
					"name": "C-003 Get Cancel Status",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status is 200', () => pm.response.to.have.status(200));",
									"pm.test('Has status field', () => pm.expect(pm.response.json()).to.have.property('status'));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "X-Request-Id",
								"value": "{{$guid}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/v1/transfers/bookings/{{bookingId}}/cancel-status",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"transfers",
								"bookings",
								"{{bookingId}}",
								"cancel-status"
							]
						}
					}
				},
				{
					"name": "C-101 Invalid BookingId (400)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status is 400', () => pm.response.to.have.status(400));",
									"pm.test('Error is INVALID_TOKEN', () => pm.expect(pm.response.json().code).to.eql('INVALID_TOKEN'));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/v1/transfers/bookings/not-a-valid-booking-id",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"transfers",
								"bookings",
								"not-a-valid-booking-id"
							]
						}
					}
				},
				{
					"name": "C-102 Tampered Signature (400)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status is 400', () => pm.response.to.have.status(400));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/v1/transfers/bookings/eyJzdXAiOiJNT1pJTyIsInJpZCI6InJlczEyMyIsImNuZiI6Ik1aMTIzNDU2In0.TAMPERED",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"transfers",
								"bookings",
								"eyJzdXAiOiJNT1pJTyIsInJpZCI6InJlczEyMyIsImNuZiI6Ik1aMTIzNDU2In0.TAMPERED"
							]
						}
					}
				}
			]
		},
		{
			"name": "06 - Booking Change",
			"item": [
				{
					"name": "BC-001 Search Changes",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"// Note: Run a search + book first to have a valid bookingId"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status is 200 or 400', () => { pm.expect([200, 400]).to.include(pm.response.code); });",
									"if (pm.response.code === 200) { var json = pm.response.json(); if (json.offers && json.offers.length > 0) { pm.collectionVariables.set('changeResultId', json.offers[0].offerId); } }"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "X-Request-Id",
								"value": "{{$guid}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"pickupLocation\": {\"address\": \"Times Square, NYC\"},\n  \"dropoffLocation\": {\"iataCode\": \"LGA\"},\n  \"pickupDateTime\": \"2026-09-01T10:00:00\",\n  \"numPassengers\": 2,\n  \"numBags\": 2,\n  \"currency\": \"USD\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/transfers/bookings/{{bookingId}}/search-changes",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"transfers",
								"bookings",
								"{{bookingId}}",
								"search-changes"
							]
						}
					}
				},
				{
					"name": "BC-002 Commit Change",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"if (!pm.collectionVariables.get('changeResultId')) { pm.collectionVariables.set('changeResultId', 'dummy-result'); }"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status is 200, 400 or 404', () => pm.expect([200, 400, 404]).to.include(pm.response.code));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "X-Request-Id",
								"value": "{{$guid}}"
							},
							{
								"key": "Idempotency-Key",
								"value": "change-{{$guid}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"resultId\": \"{{changeResultId}}\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/transfers/bookings/{{bookingId}}/commit-change",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"transfers",
								"bookings",
								"{{bookingId}}",
								"commit-change"
							]
						}
					}
				},
				{
					"name": "BC-101 Invalid BookingId (400)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status is 400', () => pm.response.to.have.status(400));",
									"pm.test('Error is INVALID_TOKEN', () => pm.expect(pm.response.json().code).to.eql('INVALID_TOKEN'));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"pickupLocation\": {\"address\": \"NYC\"},\n  \"dropoffLocation\": {\"iataCode\": \"JFK\"},\n  \"numPassengers\": 1\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/transfers/bookings/invalid-booking-token/search-changes",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"transfers",
								"bookings",
								"invalid-booking-token",
								"search-changes"
							]
						}
					}
				},
				{
					"name": "BC-102 Missing ResultId (400)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status is 400', () => pm.response.to.have.status(400));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/transfers/bookings/{{bookingId}}/commit-change",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"transfers",
								"bookings",
								"{{bookingId}}",
								"commit-change"
							]
						}
					}
				}
			]
		},
		{
			"name": "07 - Alerts",
			"item": [
				{
					"name": "A-001 Get DLQ Status",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status is 200', () => pm.response.to.have.status(200));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/v1/admin/alerts/dlq",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"admin",
								"alerts",
								"dlq"
							]
						}
					}
				},
				{
					"name": "A-002 Get Error Metrics",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status is 200', () => pm.response.to.have.status(200));",
									"pm.test('Has metrics', () => { var json = pm.response.json(); pm.expect(json).to.have.property('searchErrors'); pm.expect(json).to.have.property('bookingErrors'); });"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/v1/admin/alerts/errors",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"admin",
								"alerts",
								"errors"
							]
						}
					}
				},
				{
					"name": "A-003 Simulate DLQ Items",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status is 200', () => pm.response.to.have.status(200));",
									"pm.test('Has added count', () => pm.expect(pm.response.json()).to.have.property('added'));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/v1/admin/alerts/dlq/simulate?count=3",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"admin",
								"alerts",
								"dlq",
								"simulate"
							],
							"query": [
								{
									"key": "count",
									"value": "3"
								}
							]
						}
					}
				},
				{
					"name": "A-004 Clear DLQ",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status is 200', () => pm.response.to.have.status(200));",
									"pm.test('Has cleared count', () => pm.expect(pm.response.json()).to.have.property('cleared'));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/v1/admin/alerts/dlq",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"admin",
								"alerts",
								"dlq"
							]
						}
					}
				},
				{
					"name": "A-005 Trigger Alert Check",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status is 200', () => pm.response.to.have.status(200));",
									"pm.test('Check completed', () => pm.expect(pm.response.json().status).to.eql('check completed'));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/v1/admin/alerts/check",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"admin",
								"alerts",
								"check"
							]
						}
					}
				}
			]
		},
		{
			"name": "99 - E2E",
			"item": [
				{
					"name": "E2E-001 Step 1: Search",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Search successful', () => pm.response.to.have.status(200));",
									"var json = pm.response.json();",
									"if (json.offers && json.offers.length > 0) {",
									"  pm.collectionVariables.set('e2e_offerId', json.offers[0].offerId);",
									"  pm.collectionVariables.set('e2e_searchId', json.searchId);",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "X-Request-Id",
								"value": "e2e-search-{{$guid}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"pickupLocation\": {\"address\": \"Empire State Building, NYC\"},\n  \"dropoffLocation\": {\"iataCode\": \"JFK\"},\n  \"pickupDateTime\": \"2026-12-25T10:00:00\",\n  \"numPassengers\": 2\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/transfers/search",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"transfers",
								"search"
							]
						}
					}
				},
				{
					"name": "E2E-001 Step 2: Book",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"pm.collectionVariables.set('e2e_idempotencyKey', 'e2e-book-' + Date.now());"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Booking successful', () => pm.response.to.have.status(200));",
									"pm.collectionVariables.set('e2e_bookingId', pm.response.json().bookingId);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Idempotency-Key",
								"value": "{{e2e_idempotencyKey}}"
							},
							{
								"key": "X-Request-Id",
								"value": "e2e-book-{{$guid}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"offerId\": \"{{e2e_offerId}}\",\n  \"passenger\": {\n    \"firstName\": \"E2E\",\n    \"lastName\": \"Test\",\n    \"email\": \"e2e.test@example.com\",\n    \"phoneNumber\": \"+18001234567\",\n    \"countryCode\": \"US\"\n  },\n  \"flight\": {\"airline\": \"DL\", \"flightNumber\": \"999\"}\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/transfers/book",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"transfers",
								"book"
							]
						}
					}
				},
				{
					"name": "E2E-001 Step 3: Cancel",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Cancel successful', () => pm.response.to.have.status(200));",
									"pm.test('Status is CANCELLED', () => pm.expect(pm.response.json().status).to.eql('CANCELLED'));",
									"console.log('E2E-001 Complete!');"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "X-Request-Id",
								"value": "e2e-cancel-{{$guid}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/v1/transfers/bookings/{{e2e_bookingId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"transfers",
								"bookings",
								"{{e2e_bookingId}}"
							]
						}
					}
				},
				{
					"name": "E2E-002 Step 1: Search",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Search OK', () => pm.response.to.have.status(200));",
									"var json = pm.response.json();",
									"pm.collectionVariables.set('e2e2_searchId', json.searchId);",
									"if (json.offers && json.offers.length > 0) { pm.collectionVariables.set('e2e2_offerId', json.offers[0].offerId); }"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"pickupLocation\": {\"address\": \"Grand Central, NYC\"},\n  \"dropoffLocation\": {\"iataCode\": \"LGA\"},\n  \"pickupDateTime\": \"2026-11-15T08:00:00\",\n  \"numPassengers\": 3\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/transfers/search",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"transfers",
								"search"
							]
						}
					}
				},
				{
					"name": "E2E-002 Step 2: Poll",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Poll OK', () => pm.response.to.have.status(200));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/v1/transfers/search/{{e2e2_searchId}}/poll?sortBy=PRICE&sortDir=ASC",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"transfers",
								"search",
								"{{e2e2_searchId}}",
								"poll"
							],
							"query": [
								{
									"key": "sortBy",
									"value": "PRICE"
								},
								{
									"key": "sortDir",
									"value": "ASC"
								}
							]
						}
					}
				},
				{
					"name": "E2E-002 Step 3: Pricing",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Pricing OK', () => pm.response.to.have.status(200));",
									"pm.test('Has totalPrice', () => pm.expect(pm.response.json()).to.have.property('totalPrice'));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"searchId\": \"{{e2e2_searchId}}\",\n  \"offerId\": \"{{e2e2_offerId}}\",\n  \"amenities\": []\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/pricing",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"pricing"
							]
						}
					}
				},
				{
					"name": "E2E-002 Step 4: Book",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"pm.collectionVariables.set('e2e2_idempotencyKey', 'e2e2-' + Date.now());"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Book OK', () => pm.response.to.have.status(200));",
									"pm.collectionVariables.set('e2e2_bookingId', pm.response.json().bookingId);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Idempotency-Key",
								"value": "{{e2e2_idempotencyKey}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"offerId\": \"{{e2e2_offerId}}\",\n  \"passenger\": {\n    \"firstName\": \"E2E2\",\n    \"lastName\": \"Test\",\n    \"email\": \"e2e2@example.com\",\n    \"phoneNumber\": \"+18009999999\",\n    \"countryCode\": \"US\"\n  }\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/v1/transfers/book",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"transfers",
								"book"
							]
						}
					}
				},
				{
					"name": "E2E-002 Step 5: Cancel",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Cancel OK', () => pm.response.to.have.status(200));",
									"console.log('E2E-002 Complete!');"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/v1/transfers/bookings/{{e2e2_bookingId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"v1",
								"transfers",
								"bookings",
								"{{e2e2_bookingId}}"
							]
						}
					}
				}
			]
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					"// Auto-generate X-Request-Id if not set",
					"if (!pm.request.headers.has('X-Request-Id')) {",
					"  pm.request.headers.add({ key: 'X-Request-Id', value: pm.variables.replaceIn('{{$guid}}') });",
					"}"
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		}
	],
	"variable": [
		{
			"key": "baseUrl",
			"value": "http://localhost:8080"
		},
		{
			"key": "searchId",
			"value": ""
		},
		{
			"key": "offerId",
			"value": ""
		},
		{
			"key": "bookingId",
			"value": ""
		},
		{
			"key": "idempotencyKey",
			"value": ""
		},
		{
			"key": "idempotencyKey2",
			"value": ""
		},
		{
			"key": "changeResultId",
			"value": ""
		},
		{
			"key": "e2e_offerId",
			"value": ""
		},
		{
			"key": "e2e_searchId",
			"value": ""
		},
		{
			"key": "e2e_idempotencyKey",
			"value": ""
		},
		{
			"key": "e2e_bookingId",
			"value": ""
		},
		{
			"key": "e2e2_searchId",
			"value": ""
		},
		{
			"key": "e2e2_offerId",
			"value": ""
		},
		{
			"key": "e2e2_idempotencyKey",
			"value": ""
		},
		{
			"key": "e2e2_bookingId",
			"value": ""
		}
	]
}